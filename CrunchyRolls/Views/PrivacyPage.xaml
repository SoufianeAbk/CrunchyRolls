<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="CrunchyRolls.Views.PrivacyPage"
             Title="ðŸ”’ Privacy &amp; GDPR Settings"
             BackgroundColor="#1a1a1a">

    <Grid RowDefinitions="*, Auto" Padding="0">
        <!-- Content -->
        <ScrollView Grid.Row="0">
            <VerticalStackLayout Spacing="20" Padding="20">

                <!-- Header -->
                <Border Stroke="#FFD700" 
                        StrokeThickness="2" 
                        Padding="15">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="10"/>
                    </Border.StrokeShape>
                    <VerticalStackLayout Spacing="5">
                        <Label Text="ðŸ” GDPR Compliance"
                               FontSize="18"
                               FontAttributes="Bold"
                               TextColor="#FFD700"/>
                        <Label Text="Manage your privacy settings and data"
                               FontSize="13"
                               TextColor="#b0b0b0"/>
                    </VerticalStackLayout>
                </Border>

                <!-- Status Message -->
                <Border IsVisible="{Binding StatusMessage, Converter={StaticResource InvertedBoolConverter}}"
                        Stroke="#FF6B6B"
                        Padding="10">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="8"/>
                    </Border.StrokeShape>
                    <Label Text="{Binding StatusMessage}"
                           TextColor="#FF6B6B"
                           FontSize="12"/>
                </Border>

                <!-- Loading Indicator -->
                <ActivityIndicator IsRunning="{Binding IsLoading}"
                                   IsVisible="{Binding IsLoading}"
                                   Color="#FFD700"
                                   Scale="1.5"/>

                <!-- Consent Toggles -->
                <Label Text="Consent Preferences"
                       FontSize="16"
                       FontAttributes="Bold"
                       TextColor="#FFD700"/>

                <!-- Privacy Policy Consent -->
                <Border Stroke="#FFD700" Padding="15">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="8"/>
                    </Border.StrokeShape>
                    <Grid ColumnDefinitions="*, Auto" ColumnSpacing="10">
                        <VerticalStackLayout Grid.Column="0">
                            <Label Text="ðŸ“‹ Privacy Policy"
                                   FontSize="14"
                                   FontAttributes="Bold"
                                   TextColor="White"/>
                            <Label Text="I accept the privacy policy and data processing"
                                   FontSize="12"
                                   TextColor="#b0b0b0"/>
                        </VerticalStackLayout>
                        <CheckBox Grid.Column="1"
                                  IsChecked="{Binding ConsentPrivacyPolicy}"
                                  Color="#FFD700"
                                  VerticalOptions="Center"/>
                    </Grid>
                </Border>

                <!-- Marketing Consent -->
                <Border Stroke="#FFD700" Padding="15">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="8"/>
                    </Border.StrokeShape>
                    <Grid ColumnDefinitions="*, Auto" ColumnSpacing="10">
                        <VerticalStackLayout Grid.Column="0">
                            <Label Text="ðŸ“§ Marketing &amp; Newsletter"
                                   FontSize="14"
                                   FontAttributes="Bold"
                                   TextColor="White"/>
                            <Label Text="I want to receive promotional emails (optional)"
                                   FontSize="12"
                                   TextColor="#b0b0b0"/>
                        </VerticalStackLayout>
                        <CheckBox Grid.Column="1"
                                  IsChecked="{Binding ConsentMarketing}"
                                  Color="#FFD700"
                                  VerticalOptions="Center"/>
                    </Grid>
                </Border>

                <!-- Cookies Consent -->
                <Border Stroke="#FFD700" Padding="15">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="8"/>
                    </Border.StrokeShape>
                    <Grid ColumnDefinitions="*, Auto" ColumnSpacing="10">
                        <VerticalStackLayout Grid.Column="0">
                            <Label Text="ðŸª Cookies &amp; Analytics"
                                   FontSize="14"
                                   FontAttributes="Bold"
                                   TextColor="White"/>
                            <Label Text="Allow cookies for analytics and improvements (optional)"
                                   FontSize="12"
                                   TextColor="#b0b0b0"/>
                        </VerticalStackLayout>
                        <CheckBox Grid.Column="1"
                                  IsChecked="{Binding ConsentCookies}"
                                  Color="#FFD700"
                                  VerticalOptions="Center"/>
                    </Grid>
                </Border>

                <!-- Terms Consent -->
                <Border Stroke="#FFD700" Padding="15">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="8"/>
                    </Border.StrokeShape>
                    <Grid ColumnDefinitions="*, Auto" ColumnSpacing="10">
                        <VerticalStackLayout Grid.Column="0">
                            <Label Text="âš–ï¸ Terms &amp; Conditions"
                                   FontSize="14"
                                   FontAttributes="Bold"
                                   TextColor="White"/>
                            <Label Text="I accept the terms and conditions"
                                   FontSize="12"
                                   TextColor="#b0b0b0"/>
                        </VerticalStackLayout>
                        <CheckBox Grid.Column="1"
                                  IsChecked="{Binding ConsentTermsConditions}"
                                  Color="#FFD700"
                                  VerticalOptions="Center"/>
                    </Grid>
                </Border>

                <!-- Data Actions Section -->
                <Label Text="Your GDPR Rights"
                       FontSize="16"
                       FontAttributes="Bold"
                       TextColor="#FFD700"
                       Margin="0,20,0,0"/>

                <!-- Export Data Button -->
                <Button Text="ðŸ“¤ Export My Data"
                        Command="{Binding ExportDataCommand}"
                        Background="#4CAF50"
                        TextColor="White"
                        Padding="15"
                        CornerRadius="8"
                        FontAttributes="Bold"/>

                <!-- Save Preferences Button -->
                <Button Text="ðŸ’¾ Save Preferences"
                        Command="{Binding SaveConsentCommand}"
                        Background="#2196F3"
                        TextColor="White"
                        Padding="15"
                        CornerRadius="8"
                        FontAttributes="Bold"/>

                <!-- Delete Account Button -->
                <Button Text="ðŸ—‘ï¸ Delete Account"
                        Command="{Binding ShowDeleteConfirmationDialogCommand}"
                        Background="#FF6B6B"
                        TextColor="White"
                        Padding="15"
                        CornerRadius="8"
                        FontAttributes="Bold"/>

                <Label Text="âš ï¸ Account deletion is permanent and cannot be undone."
                       FontSize="11"
                       TextColor="#FF9800"
                       Margin="0,-5,0,0"/>

            </VerticalStackLayout>
        </ScrollView>

        <!-- Delete Confirmation Dialog -->
        <Border Grid.Row="0"
                Grid.RowSpan="2"
                IsVisible="{Binding ShowDeleteConfirmation}"
                BackgroundColor="#00000080"
                Padding="0">
            <VerticalStackLayout Spacing="20" Padding="20" VerticalOptions="Center">
                <Border BackgroundColor="#2a2a2a" Padding="20">
                    <Border.StrokeShape>
                        <RoundRectangle CornerRadius="15"/>
                    </Border.StrokeShape>
                    <VerticalStackLayout Spacing="15">
                        <Label Text="âš ï¸ Delete Account?"
                               FontSize="18"
                               FontAttributes="Bold"
                               TextColor="#FF6B6B"/>

                        <Label Text="This action is permanent and cannot be undone."
                               FontSize="13"
                               TextColor="#b0b0b0"/>

                        <Label FontSize="12"
                               TextColor="#b0b0b0"
                               LineHeight="1.5">
                            <Label.Text>
                                â€¢ Your account and personal data will be deleted
â€¢ Order history will be kept for 7 years (tax requirement)
â€¢ All sessions will be logged out
                            </Label.Text>
                        </Label>

                        <Grid ColumnDefinitions="*, *" ColumnSpacing="10">
                            <Button Grid.Column="0"
                                    Text="Cancel"
                                    Command="{Binding CancelDeletionCommand}"
                                    Background="#424242"
                                    TextColor="White"
                                    CornerRadius="8"
                                    FontAttributes="Bold"/>

                            <Button Grid.Column="1"
                                    Text="Delete My Account"
                                    Command="{Binding DeleteAccountCommand}"
                                    Background="#FF6B6B"
                                    TextColor="White"
                                    CornerRadius="8"
                                    FontAttributes="Bold"/>
                        </Grid>
                    </VerticalStackLayout>
                </Border>
            </VerticalStackLayout>
        </Border>

    </Grid>

</ContentPage>
